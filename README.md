# Intelligent placer

По поданной на вход фотографии нескольких предметов на светлой горизонтальной поверхности и многоугольнику требуется определить, можно ли расположить одновременно все эти предметы на плоскости так, чтобы они влезли в этот многоугольник. Фотографии предметов и горизонтальной плоскости находятся в папке objects. Многоугольник рисуется темным маркером на листе бумаги формата А4, который располагается на фото справа от предметов.

## Требования к входным данным
- Разрешение фотографий относительно высокое, сходное с репрезентативными примерами в папке objects.
- Высота съемки до 1м. Угол расположения камеры должен быть близок к прямому относительно плоскости расположения объектов.
- Тени на фото должны быть не слишком интенсивными: различимость краев объектов не должна нарушаться.
- Объекты не должны иметь пересечений и должны полностью располагаться на фото.
- Не допускается повторения предметов на фото.
- На вход алгоритма допускаются только выпуклые многоугольники.

## Описание алгоритма упаковки
#### Использование бароцентрических координат для представления объектов внутри прямоугольника
В условиях выпуклости ограничивающего многоугольника, любая точка внутри многоугольника может быть
представлена как выпуклая комбинация его вершин.

<img src="https://render.githubusercontent.com/render/math?math={-x = -\\alpha_1A_1-...-\\alpha_mA_m, -\\alpha_1...-\\alpha_m=-1}#gh-light-mode-only">

Тогда контур объекта с одной стороны может быть задан в локальной системе координат ограничивающего прямоугольника
в виде бароцентрических координат центра масс
<img src="https://render.githubusercontent.com/render/math?math={(\\alpha_1,...,\\alpha_m)}#gh-light-mode-only">
 и угла поворота
<img src="https://render.githubusercontent.com/render/math?math={\\gamma}#gh-light-mode-only">
вокруг условной оси, проходящей через центр масс, а с другой, может быть представлен в декартовом базисе
при отображении своего центра масс как выпуклой комбинации вершин ограничивающего прямоугольника.

#### Использование простейшего ограничивающего контура и эвристика качества упаковки
Для упрощения расположения объектов в декартовом базисе, необходимого для ряда расчетов
(поворота, вычисления и закраски занимаемой площади), построим для исходного ограничивающего контура A
описывающий его прямоугольник B, симулирующий декартову плоскость, и центрируем начало отсчета
(центр масс исходного многоугольника A). Подсчитаем, кроме того, суммарную площадь упаковываемых
объектов S.

Зададим некоторым произвольным образом бароцентрические координаты упаковываемых объектов,
отобразим их на декартов прямоугольник и подсчитаем общую площадь P пересечения области многоугольника
A и области, занимаемой объектами С. Ясно, что при самопересечениях объектов в заданном расположении,
площадь занимаемой ими области C будет меньше S. Аналогично, при выходе объектов за рамки области
многоугольника A, площадь P будет меньше площади S. Заключаем, что
<img src="https://render.githubusercontent.com/render/math?math={\\frac{P}{S}\\in(0,1)}#gh-light-mode-only">
и <img src="https://render.githubusercontent.com/render/math?math={\\frac{P}{S}\\to 1}#gh-light-mode-only">
тогда и только тогда, когда объекты упакованы в многоугольник.

#### Построение генетического алгоритма
Опираясь на вышеизложенное, попробуем построить генетический алгоритм:
- За единицу популяции возьмем вектор представлений объектов в бароцентрическом базисе.
- Критерием качества представителя популяции будем считать отношение
<img src="https://render.githubusercontent.com/render/math?math={\\frac{P}{S}}#gh-light-mode-only">
- На каждом шаге алгоритма будем отбирать наилучших представителей популяции. Для генерации новой популяции, часть из них
  будем некоторым образом скрещивать, а другую часть будем мутировать.
- Будем повторять до достижения <img src="https://render.githubusercontent.com/render/math?math={\\frac{P}{S}\\to 1}#gh-light-mode-only">
  или до выхода за допустимое количество итераций.
  
Наиболее творческим и одновременно оказывающим наибольшее влияние на динамику развития популяций, и как
следствие, на точность и работоспособность алгоритма, является выбор эвристик скрещивания и мутации.
На данном этапе построения алгоритма выбраны простейшие эвристики:
- При скрещивании представители популяции обмениваются представлениями некоторого количества произвольно выбранных объектов
- При мутации у представителей популяции меняется угол поворота
<img src="https://render.githubusercontent.com/render/math?math={\\gamma}#gh-light-mode-only">
